<!-- Timer scripts -->

{% for event in site.ourevents %}
  {% capture nowunix %}{{ site.time | date: '%s' }}{% endcapture %}
  {% capture eventunix %}{{ event['Event date'] | date: '%s'}}{% endcapture %}
  {% assign nowunix = nowunix | plus: 0 %}
  {% assign eventunix = eventunix | plus: 0 %}

  {% if nowunix < eventunix %}

    <script>

      document.addEventListener("DOMContentLoaded", function(event) {

        function getTimeRemaining(endtime) {
          var t = Date.parse(endtime) - Date.parse(new Date());
          var seconds = Math.floor((t / 1000) % 60);
          var minutes = Math.floor((t / 1000 / 60) % 60);
          var hours = Math.floor((t / (1000 * 60 * 60)) % 24);
          var days = Math.floor(t / (1000 * 60 * 60 * 24));
          return {
            'total': t,
            'days': days,
            'hours': hours,
            'minutes': minutes,
            'seconds': seconds
          };
        }

        function initializeClock(id, endtime) {
          var clock = document.getElementById(id);
          var daysSpan = clock.querySelector('.days');
          var hoursSpan = clock.querySelector('.hours');
          var minutesSpan = clock.querySelector('.minutes');
          var secondsSpan = clock.querySelector('.seconds');

          function updateClock() {
            var t = getTimeRemaining(endtime);

            daysSpan.innerHTML = t.days;
            hoursSpan.innerHTML = ('0' + t.hours).slice(-2);
            minutesSpan.innerHTML = ('0' + t.minutes).slice(-2);
            secondsSpan.innerHTML = ('0' + t.seconds).slice(-2);

            if (t.total <= 0) {
              clearInterval(timeinterval);
            }
          }

          updateClock();
          var timeinterval = setInterval(updateClock, 1000);
        }

        var deadline = '{{ event['Event date'] | date: '%B %d %Y %X' }} GMT+0700';
        initializeClock('clockdiv-{{ forloop.index }}', deadline);

      });

    </script>

  {% endif %}
{% endfor %}

<!-- Add to homescreen scripts -->

<script src="{{ "/assets/ath/src/addtohomescreen.min.js" | relative_url }}"></script>
<script>
  addToHomescreen();hub/whatsuphanoi
</script>

<!-- GA script -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-101768848-1', 'auto');
  ga('send', 'pageview');

</script>
